!function(){"use strict";class t{x=0;y=0;constructor(t,s){null==t?(this.x=0,this.y=0):"object"==typeof t?2==t.length?(this.x=t[0],this.y=t[1]):(this.x=t.x,this.y=t.y):null==s?(this.x=t,this.y=t):(this.x=t,this.y=s)}set(t,s){return this.x=t,this.y=s,this}toArray(){return[this.x,this.y]}}function i(...s){return new t(...s)}class e{constructor(t,s,i){null==t?(this.x=0,this.y=0,this.z=0):"object"==typeof t?3==t.length?(this.x=t[0],this.y=t[1],this.z=t[2]):(this.x=t.x,this.y=t.y,this.z=t.z):null==s&&null==i?(this.x=t,this.y=t,this.z=t):(this.x=t,this.y=s,this.z=i)}set(t,s,i){return this.x=t,this.y=s,this.z=i,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}cross(t){return h(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)}add(t){return"number"==typeof t?h(this.x+t,this.y+t,this.z+t):h(this.x+t.x,this.y+t.y,this.z+t.z)}sub(t){return"number"==typeof t?h(this.x-t,this.y-t,this.z-t):h(this.x-t.x,this.y-t.y,this.z-t.z)}mul(t){return"number"==typeof t?h(this.x*t,this.y*t,this.z*t):h(this.x*t.x,this.y*t.y,this.z*t.z)}div(t){return"number"==typeof t?h(this.x/t,this.y/t,this.z/t):h(this.x/t.x,this.y/t.y,this.z/t.z)}neg(){return h(-this.x,-this.y,-this.z)}len2(){return this.x*this.x+this.y*this.y+this.z*this.z}len(){let t=this.x*this.x+this.y*this.y+this.z*this.z;return 0!=t&&1!=t?Math.sqrt(t):t}normalize(){let t=this.x*this.x+this.y*this.y+this.z*this.z;return 0!=t&&1!=t?(t=Math.sqrt(t),h(this.x/t,this.y/t,this.z/t)):h(this)}min(t){return"number"==typeof t?h(Math.min(this.x,t),Math.min(this.y,t),Math.min(this.z,t)):h(Math.min(this.x,t.x),Math.min(this.y,t.y),Math.min(this.z,t.z))}max(t){return"number"==typeof t?h(Math.max(this.x,t),Math.max(this.y,t),Math.max(this.z,t)):h(Math.max(this.x,t.x),Math.max(this.y,t.y),Math.max(this.z,t.z))}toArray(){return[this.x,this.y,this.z]}}function h(...t){return new e(...t)}class r{addMethod(t,s,i){var e=t[s];t[s]=(...s)=>i.length==s.length?i.apply(t,s):"function"==typeof e?e.apply(t,s):void 0}constructor(t=null){null==t?this.m=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]]:"object"==typeof t&&4==t.length?this.m=t:this.m=t.m,this.addMethod(this,"setTranslate",((t,s,i)=>(this.m=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[t,s,i,1]],this))),this.addMethod(this,"setTranslate",(t=>this.setTranslate(t.x,t.y,t.z))),this.addMethod(this,"translate",((t,s,i)=>(this.mul([[1,0,0,0],[0,1,0,0],[0,0,1,0],[t,s,i,1]]),this))),this.addMethod(this,"translate",(t=>this.translate(t.x,t.y,t.z))),this.addMethod(this,"setScale",((t,s,i)=>(this.m=[[t,0,0,0],[0,s,0,0],[0,0,i,0],[0,0,0,1]],this))),this.addMethod(this,"setScale",(t=>"object"==typeof t?this.setScale(t.x,t.y,t.z):this.setScale(t,t,t))),this.addMethod(this,"scale",((t,s,i)=>(this.mul([[t,0,0,0],[0,s,0,0],[0,0,i,0],[0,0,0,1]]),this))),this.addMethod(this,"scale",(t=>"object"==typeof t?this.scale(t.x,t.y,t.z):this.scale(t,t,t)))}setRotate(t,s){let i=t*Math.PI/180,e=Math.sin(i),h=Math.cos(i),r=0,a=0,m=1;"object"==typeof s&&(3==s.length?(r=s[0],a=s[1],m=s[2]):(r=s.x,a=s.y,m=s.z));let n=r*r+a*a+m*m;return 0!=n&&1!=n&&(n=Math.sqrt(n),r/=n,a/=n,m/=n),this.m[0][0]=h+r*r*(1-h),this.m[0][1]=r*a*(1-h)+m*e,this.m[0][2]=r*m*(1-h)-a*e,this.m[0][3]=0,this.m[1][0]=a*r*(1-h)-m*e,this.m[1][1]=h+a*a*(1-h),this.m[1][2]=a*m*(1-h)+r*e,this.m[1][3]=0,this.m[2][0]=m*r*(1-h)+a*e,this.m[2][1]=m*a*(1-h)-r*e,this.m[2][2]=h+m*m*(1-h),this.m[2][3]=0,this.m[3][0]=0,this.m[3][1]=0,this.m[3][2]=0,this.m[3][3]=1,this}rotate(t,s){return this.mul(a().setRotate(t,s))}transpose(){let t=[[],[],[],[]];for(let s=0;s<4;s++)for(let i=0;i<4;i++)t[s][i]=this.m[i][s];return a(t)}mul(t){let s;return s=4==t.length?t:t.m,this.m=[[this.m[0][0]*s[0][0]+this.m[0][1]*s[1][0]+this.m[0][2]*s[2][0]+this.m[0][3]*s[3][0],this.m[0][0]*s[0][1]+this.m[0][1]*s[1][1]+this.m[0][2]*s[2][1]+this.m[0][3]*s[3][1],this.m[0][0]*s[0][2]+this.m[0][1]*s[1][2]+this.m[0][2]*s[2][2]+this.m[0][3]*s[3][2],this.m[0][0]*s[0][3]+this.m[0][1]*s[1][3]+this.m[0][2]*s[2][3]+this.m[0][3]*s[3][3]],[this.m[1][0]*s[0][0]+this.m[1][1]*s[1][0]+this.m[1][2]*s[2][0]+this.m[1][3]*s[3][0],this.m[1][0]*s[0][1]+this.m[1][1]*s[1][1]+this.m[1][2]*s[2][1]+this.m[1][3]*s[3][1],this.m[1][0]*s[0][2]+this.m[1][1]*s[1][2]+this.m[1][2]*s[2][2]+this.m[1][3]*s[3][2],this.m[1][0]*s[0][3]+this.m[1][1]*s[1][3]+this.m[1][2]*s[2][3]+this.m[1][3]*s[3][3]],[this.m[2][0]*s[0][0]+this.m[2][1]*s[1][0]+this.m[2][2]*s[2][0]+this.m[2][3]*s[3][0],this.m[2][0]*s[0][1]+this.m[2][1]*s[1][1]+this.m[2][2]*s[2][1]+this.m[2][3]*s[3][1],this.m[2][0]*s[0][2]+this.m[2][1]*s[1][2]+this.m[2][2]*s[2][2]+this.m[2][3]*s[3][2],this.m[2][0]*s[0][3]+this.m[2][1]*s[1][3]+this.m[2][2]*s[2][3]+this.m[2][3]*s[3][3]],[this.m[3][0]*s[0][0]+this.m[3][1]*s[1][0]+this.m[3][2]*s[2][0]+this.m[3][3]*s[3][0],this.m[3][0]*s[0][1]+this.m[3][1]*s[1][1]+this.m[3][2]*s[2][1]+this.m[3][3]*s[3][1],this.m[3][0]*s[0][2]+this.m[3][1]*s[1][2]+this.m[3][2]*s[2][2]+this.m[3][3]*s[3][2],this.m[3][0]*s[0][3]+this.m[3][1]*s[1][3]+this.m[3][2]*s[2][3]+this.m[3][3]*s[3][3]]],this}determ3x3(t,s,i,e,h,r,a,m,n){return t*h*n-t*r*m-s*e*n+s*r*a+i*e*m-i*h*a}determ(){return this.m[0][0]*this.determ3x3(this.m[1][1],this.m[1][2],this.m[1][3],this.m[2][1],this.m[2][2],this.m[2][3],this.m[3][1],this.m[3][2],this.m[3][3])-this.m[0][1]*this.determ3x3(this.m[1][0],this.m[1][2],this.m[1][3],this.m[2][0],this.m[2][2],this.m[2][3],this.m[3][0],this.m[3][2],this.m[3][3])+this.m[0][2]*this.determ3x3(this.m[1][0],this.m[1][1],this.m[1][3],this.m[2][0],this.m[2][1],this.m[2][3],this.m[3][0],this.m[3][1],this.m[3][3])-this.m[0][3]*this.determ3x3(this.m[1][0],this.m[1][1],this.m[1][2],this.m[2][0],this.m[2][1],this.m[2][2],this.m[3][0],this.m[3][1],this.m[3][2])}inverse(){let t=[[],[],[],[]],s=this.determ();if(0==s){return a([[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]])}return t[0][0]=this.determ3x3(this.m[1][1],this.m[1][2],this.m[1][3],this.m[2][1],this.m[2][2],this.m[2][3],this.m[3][1],this.m[3][2],this.m[3][3])/s,t[1][0]=-this.determ3x3(this.m[1][0],this.m[1][2],this.m[1][3],this.m[2][0],this.m[2][2],this.m[2][3],this.m[3][0],this.m[3][2],this.m[3][3])/s,t[2][0]=this.determ3x3(this.m[1][0],this.m[1][1],this.m[1][3],this.m[2][0],this.m[2][1],this.m[2][3],this.m[3][0],this.m[3][1],this.m[3][3])/s,t[3][0]=-this.determ3x3(this.m[1][0],this.m[1][1],this.m[1][2],this.m[2][0],this.m[2][1],this.m[2][2],this.m[3][0],this.m[3][1],this.m[3][2])/s,t[0][1]=-this.determ3x3(this.m[0][1],this.m[0][2],this.m[0][3],this.m[2][1],this.m[2][2],this.m[2][3],this.m[3][1],this.m[3][2],this.m[3][3])/s,t[1][1]=this.determ3x3(this.m[0][0],this.m[0][2],this.m[0][3],this.m[2][0],this.m[2][2],this.m[2][3],this.m[3][0],this.m[3][2],this.m[3][3])/s,t[2][1]=-this.determ3x3(this.m[0][0],this.m[0][1],this.m[0][3],this.m[2][0],this.m[2][1],this.m[2][3],this.m[3][0],this.m[3][1],this.m[3][3])/s,t[3][1]=this.determ3x3(this.m[0][0],this.m[0][1],this.m[0][2],this.m[2][0],this.m[2][1],this.m[2][2],this.m[3][0],this.m[3][1],this.m[3][2])/s,t[0][2]=this.determ3x3(this.m[0][1],this.m[0][2],this.m[0][3],this.m[1][1],this.m[1][2],this.m[1][3],this.m[3][1],this.m[3][2],this.m[3][3])/s,t[1][2]=-this.determ3x3(this.m[0][0],this.m[0][2],this.m[0][3],this.m[1][0],this.m[1][2],this.m[1][3],this.m[3][0],this.m[3][2],this.m[3][3])/s,t[2][2]=this.determ3x3(this.m[0][0],this.m[0][1],this.m[0][3],this.m[1][0],this.m[1][1],this.m[1][3],this.m[3][0],this.m[3][1],this.m[3][3])/s,t[3][2]=-this.determ3x3(this.m[0][0],this.m[0][1],this.m[0][2],this.m[1][0],this.m[1][1],this.m[1][2],this.m[3][0],this.m[3][1],this.m[3][2])/s,t[0][3]=-this.determ3x3(this.m[0][1],this.m[0][2],this.m[0][3],this.m[1][1],this.m[1][2],this.m[1][3],this.m[2][1],this.m[2][2],this.m[2][3])/s,t[1][3]=this.determ3x3(this.m[0][0],this.m[0][2],this.m[0][3],this.m[1][0],this.m[1][2],this.m[1][3],this.m[2][0],this.m[2][2],this.m[2][3])/s,t[2][3]=-this.determ3x3(this.m[0][0],this.m[0][1],this.m[0][3],this.m[1][0],this.m[1][1],this.m[1][3],this.m[2][0],this.m[2][1],this.m[2][3])/s,t[3][3]=this.determ3x3(this.m[0][0],this.m[0][1],this.m[0][2],this.m[1][0],this.m[1][1],this.m[1][2],this.m[2][0],this.m[2][1],this.m[2][2])/s,this.m=t,this}setIdentity(){return this.m=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],this}setView(t,s,i){let e=s.sub(t).normalize(),h=e.cross(i).normalize(),r=h.cross(e).normalize();return this.m=[[h.x,r.x,-e.x,0],[h.y,r.y,-e.y,0],[h.z,r.z,-e.z,0],[-t.dot(h),-t.dot(r),t.dot(e),1]],this}setOrtho(t,s,i,e,h,r){return this.m=[[2/(s-t),0,0,0],[0,2/(e-i),0,0],[0,0,-2/(r-h),0],[-(s+t)/(s-t),-(e+i)/(e-i),-(r+h)/(r-h),1]],this}setFrustum(t,s,i,e,h,r){return this.m=[[2*h/(s-t),0,0,0],[0,2*h/(e-i),0,0],[(s+t)/(s-t),(e+i)/(e-i),-(r+h)/(r-h),-1],[0,0,-2*h*r/(r-h),0]],this}view(t,s,i){return this.mul(a().setView(t,s,i))}ortho(t,s,i,e,h,r){return this.mul(a().setOrtho(t,s,i,e,h,r))}frustum(t,s,i,e,h,r){return this.mul(a().setFrustum(t,s,i,e,h,r))}transform(t){let s=t.x*this.m[0][3]+t.y*this.m[1][3]+t.z*this.m[2][3]+this.m[3][3];return h((t.x*this.m[0][0]+t.y*this.m[1][0]+t.z*this.m[2][0]+this.m[3][0])/s,(t.x*this.m[0][1]+t.y*this.m[1][1]+t.z*this.m[2][1]+this.m[3][1])/s,(t.x*this.m[0][2]+t.y*this.m[1][2]+t.z*this.m[2][2]+this.m[3][2])/s)}transformVector(t){return h(t.x*this.m[0][0]+t.y*this.m[1][0]+t.z*this.m[2][0],t.x*this.m[0][1]+t.y*this.m[1][1]+t.z*this.m[2][1],t.x*this.m[0][2]+t.y*this.m[1][2]+t.z*this.m[2][2])}transformPoint(t){return h(t.x*this.m[0][0]+t.y*this.m[1][0]+t.z*this.m[2][0]+this.m[3][0],t.x*this.m[0][1]+t.y*this.m[1][1]+t.z*this.m[2][1]+this.m[3][1],t.x*this.m[0][2]+t.y*this.m[1][2]+t.z*this.m[2][2]+this.m[3][2])}toArray(){return[].concat(...this.m)}}function a(...t){return new r(...t)}class m{projSize=.1;projDist=.1;projFarClip=1800;frameW=30;frameH=30;matrView=a();matrProj=a();matrVP=a();loc=h();at=h();dir=h();up=h();right=h();constructor(){this.setDef()}set(t,s,i){this.matrView.setView(t,s,i),this.loc=h(t),this.at=h(s),this.dir.set(-this.matrView.m[0][2],-this.matrView.m[1][2],-this.matrView.m[2][2]),this.up.set(this.matrView.m[0][1],this.matrView.m[1][1],this.matrView.m[2][1]),this.right.set(this.matrView.m[0][0],this.matrView.m[1][0],this.matrView.m[2][0]),this.matrVP=a(this.matrView).mul(this.matrProj)}setProj(t,s,i){let e=t,h=t;this.projDist=s,this.projSize=t,this.projFarClip=i,this.frameW>this.frameH?e*=this.frameW/this.frameH:h*=this.frameH/this.frameW,this.matrProj.setFrustum(-e/2,e/2,-h/2,h/2,s,i),this.matrVP=a(this.matrView).mul(this.matrProj)}setSize(t,s){t<1&&(t=1),s<1&&(s=1),this.frameW=t,this.frameH=s,this.setProj(this.projSize,this.projDist,this.projFarClip)}setDef(){this.loc.set(0,0,8),this.at.set(0,0,0),this.dir.set(0,0,-1),this.up.set(0,1,0),this.right.set(1,0,0),this.projDist=.1,this.projSize=.1,this.projFarClip=1800,this.frameW=30,this.frameH=30,this.set(this.loc,this.at,this.up),this.setProj(this.projSize,this.projDist,this.projFarClip),this.setSize(this.frameW,this.frameH)}}function n(...t){return new m(t)}function l(t){let s=[];const i=t=>{if("object"==typeof t)if(null!=t.toArray)s=s.concat(t.toArray());else if(Array.isArray(t))for(let s=0;s<t.length;s++)i(t[s]);else for(let s in t)i(t[s]);else"boolean"==typeof t?s.push(Number(t)):"number"==typeof t&&s.push(t)};return i(t),s}class o{constructor(t,s,i){let e,h;this.rnd=t,this.type=s,"number"==typeof i?(h=i,e=null):i instanceof Float32Array||i instanceof Uint32Array?(e=i,h=4*e.length):(e=l(i),h=4*e.length),this.size=h,this.id=null,0!=h&&null!=s&&(this.id=t.gl.createBuffer(),t.gl.bindBuffer(s,this.id),t.gl.bufferData(s,h,t.gl.STATIC_DRAW),null!=e&&(e instanceof Float32Array||e instanceof Uint32Array?(this.rnd.gl.bindBuffer(this.type,this.id),this.rnd.gl.bufferSubData(this.type,0,e,0)):(this.rnd.gl.bindBuffer(this.type,this.id),this.rnd.gl.bufferSubData(this.type,0,new Float32Array(e),0))))}update(t){null!=this.id&&(t instanceof Float32Array||t instanceof Uint32Array?(this.rnd.gl.bindBuffer(this.type,this.id),this.rnd.gl.bufferSubData(this.type,0,t,0)):(this.rnd.gl.bindBuffer(this.type,this.id),this.rnd.gl.bufferSubData(this.type,0,new Float32Array(l(t)),0)))}}class d extends o{constructor(t,s,i,e){super(t,t.gl.UNIFORM_BUFFER,i),this.name=s,this.bindPoint=e}apply(t){null!=t&&null!=t.id&&null!=t.id&&null!=t.uniformBlocks[this.name]&&(this.rnd.gl.uniformBlockBinding(t.id,t.uniformBlocks[this.name].index,this.bindPoint),this.rnd.gl.bindBufferBase(this.rnd.gl.UNIFORM_BUFFER,this.bindPoint,this.id))}}function c(...t){return new d(...t)}class u extends o{constructor(t,s,i){let e=0;"number"==typeof i?e=i:"object"==typeof i&&(e=i.length),super(t,t.gl.ARRAY_BUFFER,e*s),"object"==typeof i&&this.update(i)}apply(){null!=this.id&&this.rnd.gl.bindBuffer(this.rnd.gl.ARRAY_BUFFER,this.id)}}function f(...t){return new u(...t)}class g extends o{constructor(t,s){let i=0;"number"==typeof s?i=s:"object"==typeof s&&(i=s.length),super(t,t.gl.ELEMENT_ARRAY_BUFFER,4*i),"object"==typeof s&&(t.gl.bindBuffer(t.gl.ELEMENT_ARRAY_BUFFER,this.id),t.gl.bufferSubData(this.type,0,new Uint32Array(s),0))}apply(){this.rnd.gl.bindBuffer(this.rnd.gl.ELEMENT_ARRAY_BUFFER,this.id)}}function p(...t){return new g(...t)}class y{async _init(t){this.name=t,vg.log("Shader load: "+this.name),this.id=null,this.attrs={},this.uniforms={},this.uniformBlocks={},this.shaders=[{id:null,type:this.rnd.gl.VERTEX_SHADER,name:"vert",src:""},{id:null,type:this.rnd.gl.FRAGMENT_SHADER,name:"frag",src:""}];for(const s of this.shaders){let i=await fetch(`bin/shaders/${t}/${s.name}.glsl?30472908${Math.random()}`),e=await i.text();"string"==typeof e&&""!=e&&(s.src=e)}this.updateShaderSource()}updateShaderSource(){let t=vg.log(`Shader ${this.name} update`);if(this.shaders[0].id=null,this.shaders[1].id=null,this.id=null,""!=this.shaders[0].src&&""!=this.shaders[1].src){if(this.shaders.forEach((s=>{if(s.id=this.rnd.gl.createShader(s.type),this.rnd.gl.shaderSource(s.id,s.src),this.rnd.gl.compileShader(s.id),!this.rnd.gl.getShaderParameter(s.id,this.rnd.gl.COMPILE_STATUS)){let i=this.rnd.gl.getShaderInfoLog(s.id);vg.logAdd(` [${s.name}] fail:\n${i}`,t),console.log(` [${s.name}] fail:\n${i}`)}})),this.id=this.rnd.gl.createProgram(),this.shaders.forEach((t=>{null!=t.id&&this.rnd.gl.attachShader(this.id,t.id)})),this.rnd.gl.linkProgram(this.id),!this.rnd.gl.getProgramParameter(this.id,this.rnd.gl.LINK_STATUS)){const t=this.rnd.gl.getProgramInfoLog(this.id);vg.logAdd(` [prog] fail:\n${t}`),console.log(` [${s.name}] fail:\n${t}`)}this.updateShaderData()}}updateShaderData(){this.attrs={};let t=this.rnd.gl.getProgramParameter(this.id,this.rnd.gl.ACTIVE_ATTRIBUTES);for(let s=0;s<t;s++){const t=this.rnd.gl.getActiveAttrib(this.id,s);this.attrs[t.name]={name:t.name,type:t.type,size:t.size,loc:this.rnd.gl.getAttribLocation(this.id,t.name)}}this.uniforms={};let s=this.rnd.gl.getProgramParameter(this.id,this.rnd.gl.ACTIVE_UNIFORMS);for(let t=0;t<s;t++){const s=this.rnd.gl.getActiveUniform(this.id,t);this.uniforms[s.name]={name:s.name,type:s.type,size:s.size,loc:this.rnd.gl.getUniformLocation(this.id,s.name)}}this.uniformBlocks={};let i=this.rnd.gl.getProgramParameter(this.id,this.rnd.gl.ACTIVE_UNIFORM_BLOCKS);for(let t=0;t<i;t++){const s=this.rnd.gl.getActiveUniformBlockName(this.id,t),i=this.rnd.gl.getUniformBlockIndex(this.id,s);this.uniformBlocks[s]={name:s,index:i,size:this.rnd.gl.getActiveUniformBlockParameter(this.id,i,this.rnd.gl.UNIFORM_BLOCK_DATA_SIZE),bind:this.rnd.gl.getActiveUniformBlockParameter(this.id,i,this.rnd.gl.UNIFORM_BLOCK_BINDING)}}}constructor(t,s){this.rnd=t,this._init(s)}apply(){null!=this.id&&this.rnd.gl.useProgram(this.id)}}function v(t,s){return new y(t,s)}class x{constructor(...t){if(t[0]instanceof x){Object.assign(this,t[0]);let s=t[1];this.textures=[];for(let t in s){let i=s[t];t=Number(t),this.textures[t]=texture(i),t>=0&&t<=3&&(this.mtlData.textureFlags[t]=1)}return}let s=t[1],i=t[2];this.name=t[0],this.shader=null,this.mtlData={ambient:[.1,.1,.1,0],diffuse:[.8,.8,.8,1],specular:[.5,.5,.5,47],textureFlags:[0,0,0,0]},s&&(s.ka&&(this.mtlData.ambient=s.ka.toArray().concat([0])),s.kd&&(s.trans?this.mtlData.diffuse=s.kd.toArray().concat([s.trans]):this.mtlData.diffuse=s.kd.toArray().concat([1])),s.ks&&s.ph&&(this.mtlData.specular=s.ks.toArray().concat([s.ph]))),this.textures=[];for(let t in i){let s=i[t];t=Number(t),this.textures[t]=texture(s),t>=0&&t<=3&&(this.mtlData.textureFlags[t]=1)}}setShd(t){return this.shader=t,this}apply(t){null==this.mtlBuf&&(this.mtlBuf=c(t,"mtlBuffer",64,5),this.mtlBuf.update(this.mtlData)),null==this.shader&&(this.shader=t.shaders.default),null!=this.shader.id&&(this.shader.apply(),this.mtlBuf.apply(this.shader))}}function k(...t){return new x(...t)}k.materialLibInit=t=>{t.materialLib={Default:k("Default",{ka:h(.2,.2,.2),kd:h(.8,.8,.8),ks:h(.5,.5,.5),ph:102}),BlackPlastic:k("Black Plastic",{ka:h(0,0,0),kd:h(.01,.01,.01),ks:h(.5,.5,.5),ph:32}),Brass:k("Brass",{ka:h(.329412,.223529,.027451),kd:h(.780392,.568627,.113725),ks:h(.992157,.941176,.807843),ph:27.8974}),Bronze:k("Bronze",{ka:h(.2125,.1275,.054),kd:h(.714,.4284,.18144),ks:h(.393548,.271906,.166721),ph:25.6}),Chrome:k("Chrome",{ka:h(.25,.25,.25),kd:h(.4,.4,.4),ks:h(.774597,.774597,.774597),ph:76.8}),Copper:k("Copper",{ka:h(.19125,.0735,.0225),kd:h(.7038,.27048,.0828),ks:h(.256777,.137622,.086014),ph:12.8}),Gold:k("Gold",{ka:h(.24725,.1995,.0745),kd:h(.75164,.60648,.22648),ks:h(.628281,.555802,.366065),ph:51.2}),Peweter:k("Peweter",{ka:h(.10588,.058824,.113725),kd:h(.427451,.470588,.541176),ks:h(.3333,.3333,.521569),ph:9.84615}),Silver:k("Silver",{ka:h(.19225,.19225,.19225),kd:h(.50754,.50754,.50754),ks:h(.508273,.508273,.508273),ph:51.2}),PolishedSilver:k("Polished Silver",{ka:h(.23125,.23125,.23125),kd:h(.2775,.2775,.2775),ks:h(.773911,.773911,.773911),ph:89.6}),Turquoise:k("Turquoise",{ka:h(.1,.18725,.1745),kd:h(.396,.74151,.69102),ks:h(.297254,.30829,.306678),ph:12.8}),Ruby:k("Ruby",{ka:h(.1745,.01175,.01175),kd:h(.61424,.04136,.04136),ks:h(.727811,.626959,.626959),ph:76.8}),PolishedGold:k("Polished Gold",{ka:h(.24725,.2245,.0645),kd:h(.34615,.3143,.0903),ks:h(.797357,.723991,.208006),ph:83.2}),PolishedBronze:k("Polished Bronze",{ka:h(.25,.148,.06475),kd:h(.4,.2368,.1036),ks:h(.774597,.458561,.200621),ph:76.8}),PolishedCopper:k("Polished Copper",{ka:h(.2295,.08825,.0275),kd:h(.5508,.2118,.066),ks:h(.580594,.223257,.0695701),ph:51.2}),Jade:k("Jade",{ka:h(.135,.2225,.1575),kd:h(.135,.2225,.1575),ks:h(.316228,.316228,.316228),ph:12.8}),Obsidian:k("Obsidian",{ka:h(.05375,.05,.06625),kd:h(.18275,.17,.22525),ks:h(.332741,.328634,.346435),ph:38.4}),Pearl:k("Pearl",{ka:h(.25,.20725,.20725),kd:h(1,.829,.829),ks:h(.296648,.296648,.296648),ph:11.264}),Emerald:k("Emerald",{ka:h(.0215,.1745,.0215),kd:h(.07568,.61424,.07568),ks:h(.633,.727811,.633),ph:76.8}),BlackPlastic:k("Black Plastic",{ka:h(0,0,0),kd:h(.01,.01,.01),ks:h(.5,.5,.5),ph:32}),BlackRubber:k("Black Rubber",{ka:h(.02,.02,.02),kd:h(.01,.01,.01),ks:h(.4,.4,.4),ph:10})}};class D{constructor(t,s,e=i(1,1)){this.pos=h(t),this.norm=h(s),this.texCoord=i(e)}}class B{static default_mtl=k({ka:h(.1),kd:h(.8),ks:h(.5),trans:0});mtl;constructor(t,...s){if(this.rnd=t,this.vBuf=f(t,0),this.iBuf=p(t,0),this.va=null,this.numElements=0,this.transform=a(),this.stride=32,this.offsets={InPosition:0,InNormal:12,InTexCoords:24},this.minBB=h(0,0,0),this.maxBB=h(0,0,0),this.mtl=B.default_mtl,1==s.length)"number"==typeof s[0]?this.numElements=s[0]:"object"==typeof s[0]&&s[0].stride?(this.stride=s[0].stride,s[0].vBuf&&(this.vBuf=f(t,this.stride,s[0].vBuf),this.numElements=s[0].vBuf.length),s[0].iBuf&&(this.iBuf=p(t,s[0].iBuf),this.numElements=s[0].iBuf.length),s[0].offsets&&(this.offsets=s[0].offsets)):(this.vBuf=f(t,this.stride,s[0]),this.numElements=s[0].length);else{let[i,e]=s;this.vBuf=f(t,this.stride,i),this.iBuf=p(t,e),this.numElements=e.length}}setMtl(t){return this.mtl=t,this}draw(t=null){this.mtl.apply(this.rnd),null!=this.mtl.shader.id&&(null==this.va&&null!=this.vBuf.id&&(this.vBuf.apply(),this.va=this.rnd.gl.createVertexArray(),this.rnd.gl.bindVertexArray(this.va),[["InPosition",3],["InNormal",3],["InTexCoords",2]].forEach((t=>{this.mtl.shader.attrs[t[0]]&&(this.rnd.gl.vertexAttribPointer(this.mtl.shader.attrs[t[0]].loc,t[1],this.rnd.gl.FLOAT,!1,this.stride,this.offsets[t[0]]),this.rnd.gl.enableVertexAttribArray(this.mtl.shader.attrs[t[0]].loc))}))),this.rnd.frameBuf.apply(this.mtl.shader),this.rnd.primData.MatrW=a(this.transform),t&&this.rnd.primData.MatrW.mul(t),this.rnd.primData.MatrWVP=a(this.rnd.primData.MatrW).mul(this.rnd.cam.matrVP),this.rnd.primData.MatrInvWTrans=a(this.rnd.primData.MatrW).inverse().transpose(),this.rnd.primBuf.update(this.rnd.primData),this.rnd.primBuf.apply(this.mtl.shader),null!=this.va&&this.rnd.gl.bindVertexArray(this.va),null==this.iBuf.id?this.rnd.gl.drawArrays(this.rnd.gl.TRIANGLES,0,this.numElements):(this.iBuf.apply(),this.rnd.gl.drawElements(this.rnd.gl.TRIANGLES,this.numElements,this.rnd.gl.UNSIGNED_INT,0)))}}function b(...t){return new B(...t)}let z=(t,s,i)=>s.sub(t).cross(i.sub(t)).normalize();function M(){const t=()=>{const t=new Date;return t.getMilliseconds()/1e3+t.getSeconds()+60*t.getMinutes()};return this.response=(s=null)=>{let i=t();this.globalTime=i,this.globalDeltaTime=i-this.oldTime,this.isPause?(this.localDeltaTime=0,this.pauseTime+=i-this.oldTime):(this.localDeltaTime=this.globalDeltaTime,this.localTime=i-this.pauseTime-this.startTime),this.frameCounter++,i-this.oldTimeFPS>3&&(this.FPS=this.frameCounter/(i-this.oldTimeFPS),this.oldTimeFPS=i,this.frameCounter=0,null!=s&&(document.getElementById(s).innerHTML=this.getFPS())),this.oldTime=i},this.getFPS=()=>this.FPS.toFixed(3),this.globalTime=this.localTime=t(),this.globalDeltaTime=this.localDeltaTime=0,this.startTime=this.oldTime=this.oldTimeFPS=this.globalTime,this.frameCounter=0,this.isPause=!1,this.FPS=30,this.pauseTime=0,this}b.addPrimitives=t=>{t.primCreateTetrahedron=()=>{let s=Math.sqrt(2),i=Math.sqrt(3),e=s*i/2,r=h(-s*i/6,0,-s/2),a=h(-s*i/6,0,s/2),m=h(s*i/3,0,0),n=h(0,e,0),l=z(r,m,n).neg(),o=z(m,a,n).neg(),d=z(a,r,n).neg(),c=z(r,a,m).neg();return t.primCreate([vg.vertex(r,l),vg.vertex(m,l),vg.vertex(n,l),vg.vertex(m,o),vg.vertex(a,o),vg.vertex(n,o),vg.vertex(a,d),vg.vertex(r,d),vg.vertex(n,d),vg.vertex(r,c),vg.vertex(a,c),vg.vertex(m,c)])},t.primCreateCube=()=>{let s=1/Math.sqrt(3),e=[h(-s,-s,-s),h(-s,-s,s),h(s,-s,-s),h(s,-s,s),h(-s,s,-s),h(-s,s,s),h(s,s,-s),h(s,s,s)],r=[h(-1,0,0),h(0,0,1),h(1,0,0),h(0,0,-1),h(0,1,0),h(0,-1,0)],a={f0:{v:[0,1,5,4],n:0},f1:{v:[1,3,7,5],n:1},f2:{v:[3,2,6,7],n:2},f3:{v:[0,4,6,2],n:3},f4:{v:[4,5,7,6],n:4},f5:{v:[0,2,3,1],n:5}},m=[i(0,1),i(0,0),i(1,0),i(1,1)],n=[],l=[],o=0;for(let t in a){for(let s=0;s<a[t].v.length;s++)n.push(vg.vertex(e[a[t].v[s]],r[a[t].n],m[s]));for(let s=1;s<a[t].v.length-1;s++)l=l.concat([o+0,o+s,o+s+1]);o+=a[t].v.length}return t.primCreate(n,l)},t.primCreateIcosahedron=()=>{let s=Math.sqrt(5)/2,i=1/s,e=[];for(let t=0;t<360;t+=72){let s=t*Math.PI/180;e.push(h(i*Math.sin(s),-.5*i,i*Math.cos(s)))}for(let t=0;t<360;t+=72){let s=(t+36)*Math.PI/180;e.push(h(i*Math.sin(s),.5*i,i*Math.cos(s)))}let r=[];for(let t=0;t<5;t++){let s=e[t],i=e[5+t],h=e[(t+1)%5],a=e[(t+1)%5+5],m=z(s,h,i),n=z(i,h,a);r.push(vg.vertex(s,m)),r.push(vg.vertex(h,m)),r.push(vg.vertex(i,m)),r.push(vg.vertex(i,n)),r.push(vg.vertex(h,n)),r.push(vg.vertex(a,n))}let a=i*s,m=h(0,-a,0),n=h(0,a,0);for(let t=0;t<5;t++){let s=e[t],i=e[5+t],h=e[(t+1)%5],a=e[(t+1)%5+5],l=z(s,m,h),o=z(i,a,n);r.push(vg.vertex(s,l)),r.push(vg.vertex(m,l)),r.push(vg.vertex(h,l)),r.push(vg.vertex(i,o)),r.push(vg.vertex(a,o)),r.push(vg.vertex(n,o))}return t.primCreate(r)},t.primCreateOctahedron=()=>{let s=[h(-1,0,0),h(0,0,1),h(1,0,0),h(0,0,-1),h(0,1,0),h(0,-1,0)],i=[[0,1,4],[1,2,4],[2,3,4],[3,0,4],[0,5,1],[1,5,2],[2,5,3],[3,5,0]],e=[];for(let t=0;t<i.length;t++){let h=s[i[t][0]],r=s[i[t][1]],a=s[i[t][2]],m=z(h,r,a);e.push(vg.vertex(h,m)),e.push(vg.vertex(r,m)),e.push(vg.vertex(a,m))}return t.primCreate(e)},t.primCreateDodecahedron=()=>{let s=Math.sqrt(5)/2,i=1/s,e=[];for(let t=0;t<360;t+=72){let s=t*Math.PI/180;e.push(h(i*Math.sin(s),-.5*i,i*Math.cos(s)))}for(let t=0;t<360;t+=72){let s=(t+36)*Math.PI/180;e.push(h(i*Math.sin(s),.5*i,i*Math.cos(s)))}let r=[];for(let t=0;t<5;t++){let s=e[t],i=e[5+t],h=e[(t+1)%5],a=e[(t+1)%5+5];r.push(s.add(h).add(i).div(3)),r.push(i.add(h).add(a).div(3))}let a=[],m=[],n=i*s,l=h(0,-n,0),o=h(0,n,0);for(let t=0;t<5;t++){let s=e[t],i=e[5+t],h=e[(t+1)%5],r=e[(t+1)%5+5];m.unshift(s.add(l).add(h).div(3)),a.push(i.add(r).add(o).div(3))}let d=[],c=[],u=0;[a,m].forEach((t=>{let s=z(t[0],t[1],t[2]);t.forEach((t=>c.push(vg.vertex(t,s)))),d=d.concat([u+0,u+1,u+2,u+0,u+2,u+3,u+0,u+3,u+4]),u+=5}));for(let t=0;t<5;t++){let s=[r[(2*t+1)%10],r[(2*t+2)%10],r[(2*t+3)%10],a[(t+1)%5],a[t+0]],i=z(s[0],s[1],s[2]);s.forEach((t=>c.push(vg.vertex(t,i)))),d=d.concat([u+0,u+1,u+2,u+0,u+2,u+3,u+0,u+3,u+4]),u+=5}for(let t=0;t<5;t++){let s=[m[4-t+0],m[4-(t+1)%5],r[(2*t+2)%10],r[(2*t+1)%10],r[(2*t+0)%10]],i=z(s[0],s[1],s[2]);s.forEach((t=>c.push(vg.vertex(t,i)))),d=d.concat([u+0,u+1,u+2,u+0,u+2,u+3,u+0,u+3,u+4]),u+=5}return t.primCreate(c,d)}};const w=t=>180*t/Math.PI;function T(t,s){return Math.sqrt(Math.pow(t.clientX-s.clientX,2)+Math.pow(t.clientY-s.clientY,2))}class E{constructor(t){t.canvas.addEventListener("mousemove",(t=>this.onMouseMove(t))),t.canvas.addEventListener("mousewheel",(t=>this.onMouseWheel(t))),t.canvas.addEventListener("mousedown",(t=>this.onMouseDown(t))),t.canvas.addEventListener("mouseup",(t=>this.onMouseUp(t))),t.canvas.addEventListener("contextmenu",(t=>t.preventDefault())),"ontouchstart"in document.documentElement&&(t.canvas.addEventListener("touchstart",(t=>this.onTouchStart(t))),t.canvas.addEventListener("touchmove",(t=>this.onTouchMove(t))),t.canvas.addEventListener("touchend",(t=>this.onTouchEnd(t)))),window.addEventListener("keydown",(t=>this.onKeyDown(t))),window.addEventListener("keyup",(t=>this.onKeyUp(t))),this.mX=0,this.mY=0,this.mZ=0,this.mDx=0,this.mDy=0,this.mDz=0,this.mButtons=[0,0,0,0,0],this.mButtonsOld=[0,0,0,0,0],this.mButtonsClick=[0,0,0,0,0],this.scaling=!1,this.dist=0,this.scale_factor=1,this.curr_scale=1,this.max_zoom=8,this.min_zoom=.5,this.keys=[],this.keysOld=[],this.keysClick=[],["Enter","Backspace","Delete","Space","Tab","Escape","ArrowLeft","ArrowUp","ArrowRight","ArrowDown","Shift","Control","Alt","ShiftLeft","ShiftRight","ControlLeft","ControlRight","PageUp","PageDown","End","Home","Digit0","Digit1","KeyA","Numpad0","NumpadMultiply","F1"].forEach((t=>{this.keys[t]=0,this.keysOld[t]=0,this.keysClick[t]=0})),this.shiftKey=!1,this.altKey=!1,this.ctrlKey=!1,this.isFirst=!0}onClick(t){}onTouchStart(t){1==t.touches.length?this.mButtons[0]=1:2==t.touches.length?(this.mButtons[0]=0,this.mButtons[2]=1):(this.mButtons[0]=0,this.mButtons[2]=0,this.mButtons[1]=1);let s=t.targetTouches[0].pageX-t.target.offsetLeft,i=t.targetTouches[0].pageY-t.target.offsetTop;this.mDx=0,this.mDy=0,this.mDz=0,this.mX=s,this.mY=i;let e=t.targetTouches;e.length>=2?(this.dist=T(e[0],e[1]),this.scaling=!0):this.scaling=!1}onTouchMove(t){t.preventDefault();let s=t.targetTouches[0].pageX-t.target.offsetLeft,i=t.targetTouches[0].pageY-t.target.offsetTop,e=t.targetTouches;if(this.scaling){this.mDz=0,this.curr_scale=T(e[0],e[1])/this.dist*this.scale_factor;let t=T(e[0],e[1]);if(Math.abs(t-this.dist)>0)return t<this.dist?(this.mDz=t/this.dist*1,this.dist=t):t>this.dist&&(this.mDz=this.dist/t*-1,this.dist=t),this.mZ+=this.mDz,this.mDx=s-this.mX,this.mDy=i-this.mY,this.mX=s,void(this.mY=i)}1==this.mButtons[1]?(this.mDx=0,this.mDy=0,this.mDz=i-this.mZ,this.mX=s,this.mY=i,this.mZ+=this.mDz):(this.mDx=s-this.mX,this.mDy=i-this.mY,this.mDz=0,this.mX=s,this.mY=i)}onTouchEnd(t){this.mButtons[0]=0,this.mButtons[1]=0,this.mButtons[2]=0;let s=t.targetTouches[0].pageX-t.target.offsetLeft,i=t.targetTouches[0].pageY-t.target.offsetTop;this.mDx=0,this.mDy=0,this.mDz=0,this.mX=s,this.mY=i,t.targetTouches.length<2?(this.scaling=!1,this.curr_scale<this.min_zoom?this.scale_factor=this.min_zoom:this.curr_scale>this.max_zoom?this.scale_factor=this.max_zoom:this.scale_factor=this.curr_scale):this.scaling=!0}onMouseMove(t){let s=t.movementX,i=t.movementY;this.mDx=s,this.mDy=i,this.mDz=0,this.mX+=s,this.mY+=i}onMouseWheel(t){0!=t.wheelDelta&&t.preventDefault(),this.mZ+=this.mDz=t.wheelDelta/120}onMouseDown(t){t.preventDefault(),this.mDx=0,this.mDy=0,this.mDz=0,this.mButtonsOld[t.button]=this.mButtons[t.button],this.mButtons[t.button]=1,this.mButtonsClick[t.button]=!this.mButtonsOld[t.button]&&this.mButtons[t.button],this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.ctrlKey=t.ctrlKey}onMouseUp(t){t.preventDefault(),this.mDx=0,this.mDy=0,this.mDz=0,this.mButtonsOld[t.button]=this.mButtons[t.button],this.mButtons[t.button]=0,this.mButtonsClick[t.button]=0,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.ctrlKey=t.ctrlKey}onKeyDown(t){if("textarea"==t.target.tagName.toLowerCase())return;let s=null;document.hasFocus()&&document.activeElement!==document.body&&document.activeElement!==document.documentElement&&(s=document.activeElement,"textarea"==s.tagName.toLowerCase())||("F12"!=t.code&&"F11"!=t.code&&"KeyR"!=t.code&&t.preventDefault(),this.keysOld[t.code]=this.keys[t.code],this.keys[t.code]=1,this.keysClick[t.code]=!this.keysOld[t.code]&&this.keys[t.code],this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.ctrlKey=t.ctrlKey)}onKeyUp(t){if("textarea"==t.target.tagName.toLowerCase())return;let s=null;document.hasFocus()&&document.activeElement!==document.body&&document.activeElement!==document.documentElement&&(s=document.activeElement,"textarea"==s.tagName.toLowerCase())||("F12"!=t.code&&"F11"!=t.code&&"KeyR"!=t.code&&t.preventDefault(),this.keysOld[t.code]=this.keys[t.code],this.keys[t.code]=0,this.keysClick[t.code]=0,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.ctrlKey=t.ctrlKey)}reset(){this.mDx=0,this.mDy=0,this.mDz=0,this.mButtonsClick.forEach((t=>this.mButtonsClick[t]=0)),this.keysClick.forEach((t=>this.keysClick[t]=0)),this.shiftKey=this.keys.ShiftLeft||this.keys.ShiftRight,this.altKey=this.keys.AltLeft||this.keys.AltRight,this.ctrlKey=this.keys.ControlLeft||this.keys.ControlRight}responseCamera(t){if(this.shiftKey&&this.keysClick.KeyF)t.cam.set(h(5),h(0),h(0,1,0));else{let s=h(t.cam.at).sub(t.cam.loc).len(),i=(t.cam.loc.y-t.cam.at.y)/s,e=Math.sqrt(1-i*i),r=s*e,m=(t.cam.loc.z-t.cam.at.z)/r,n=(t.cam.loc.x-t.cam.at.x)/r,l=w(Math.atan2(n,m)),o=w(Math.atan2(e,i));if(l+=3*t.timer.globalDeltaTime*(-30*this.mButtons[0]*this.mDx+47*(this.keys.ArrowLeft-this.keys.ArrowRight)),o+=2*t.timer.globalDeltaTime*(-30*this.mButtons[0]*this.mDy+47*(this.keys.ArrowUp-this.keys.ArrowDown)),o<.08?o=.08:o>178.9&&(o=178.9),s+=t.timer.globalDeltaTime*(1+18*this.shiftKey)*(8*this.mDz+8*(this.keys.PageUp-this.keys.PageDown)),s<.1&&(s=.1),this.mButtons[2]){let i=t.cam.projSize,e=t.cam.projSize;t.cam.frameW>t.cam.frameH?i*=t.cam.frameW/t.cam.frameH:e*=t.cam.frameH/t.cam.frameW;let h=-this.mDx*i/t.cam.frameW*s/t.cam.projDist,r=this.mDy*e/t.cam.frameH*s/t.cam.projDist,a=t.cam.right.mul(h).add(t.cam.up.mul(r));t.cam.at=t.cam.at.add(a),t.cam.loc=t.cam.loc.add(a)}t.cam.set(a().setRotate(o,h(1,0,0)).rotate(l,h(0,1,0)).translate(t.cam.at).transformPoint(h(0,s,0)),t.cam.at,h(0,1,0))}}}class A{cam=n();timer=new M;frameData={camLoc:[1,2,3,4],camRight:[1,2,3,4],camUp:[1,2,3,4],camDir:[1,2,3,4],sizes:[1,2,3,4],time:[1,2,3,4],flags:[0,1,1,0]};primData={MatrWVP:a(),MatrW:a(),MatrInvWTrans:a()};timer=new M;constructor(t,s){"string"==typeof t&&(t=document.getElementById(t)),this.canvas=t;let i=t.getContext("webgl2");this.gl=i,this.input=new E(this),this.frameBuf=c(this,"frameBuffer",this.frameData,1),this.primBuf=c(this,"primBuffer",this.primData,2),this.cam.setSize(i.canvas.width,i.canvas.height),this.primitives=[],this.shaders={default:v(this,"default")},this.addShader=t=>{if(!this.shaders.name)return this.shaders[t]=v(this,t)},i.clearColor(.3,.47,.8,1),i.enable(i.DEPTH_TEST),i.enable(i.BLEND),i.blendFunc(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA),b.addPrimitives(this),k.materialLibInit(this),s(this)}primCreate(...t){let s=b(this,...t);return this.primitives.push(s),s}renderLoop(t){const s=()=>{this.input.responseCamera(this),this.cam.setSize(this.gl.canvas.clientWidth,this.gl.canvas.clientHeight),this.gl.canvas.width=this.gl.canvas.clientWidth,this.gl.canvas.height=this.gl.canvas.clientHeight,this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.timer.response(),this.frameData.camLoc=this.cam.loc.toArray().concat([0]),this.frameData.camRight=this.cam.right.toArray().concat([0]),this.frameData.camUp=this.cam.up.toArray().concat([0]),this.frameData.camDir=this.cam.dir.toArray().concat([0]),this.frameData.sizes=[this.cam.frameW,this.cam.frameH,this.cam.projSize,this.cam.projDist],this.frameData.time=[this.timer.localTime,this.timer.localDeltaTime,this.timer.globalTime,this.timer.globalDeltaTime],this.frameBuf.update(this.frameData),t&&t(this),this.input.reset(),window.requestAnimationFrame(s)};s()}}if(null==window.vg){window.vec2=i,window.vec3=h,window.mat4=a,window.camera=n,window.vg={},window.vg.vertex=function(...t){return new D(...t)},window.vg.render=function(...t){return new A(...t)};let t=0;window.vg.log=s=>{let i=document.getElementById("log");return i?(i.innerHTML+=`[${t}]: ${s}\n`,i.scrollTop=i.scrollHeight):console.log(s),t++},window.vg.logAdd=(t,s=-1)=>{if(-1==s)vg.log(t);else{let i=document.getElementById("log");if(i){let e,h=i.innerHTML,r=h.indexOf(`[${s}]: `);-1==r||-1==(e=h.indexOf("\n[",r))?(-1==r?h+=`[${s}]: ${t}\n`:h=h.slice(0,-1)+`${t}\n`,i.scrollTop=i.scrollHeight):h=h.slice(0,r)+h.slice(r,e)+t+h.slice(e),i.innerHTML=h}else console.log(t)}}}window.addEventListener("load",(()=>{vg.log("CGSG forever!!! main.js imported"),function(){let t=document.getElementById("myCan");const s=vg.render(t,(t=>{}));s.canvas.parentNode.querySelector(".pause").onclick=t=>{s.timer.isPause=!!t.target.checked};let i={Tetrahedron:s.primCreateTetrahedron(),Cube:s.primCreateCube(),Icosahedron:s.primCreateIcosahedron(),Octahedron:s.primCreateOctahedron(),Dodecahedron:s.primCreateDodecahedron(),Chaos:[]};for(let t=0;t<540;t++){const t=["Tetrahedron","Cube","Icosahedron","Octahedron","Dodecahedron"];let e=s["primCreate"+t[Math.trunc(Math.random()*t.length)]]();e.setMtl(s.materialLib[Object.keys(s.materialLib)[Math.trunc(Math.random()*Object.keys(s.materialLib).length)]]),i.Chaos.push([e,vec3(2*Math.random()-1,2*Math.random()-1,2*Math.random()-1).mul(47),vec3(2*Math.random()-1,2*Math.random()-1,2*Math.random()-1),97*Math.random()+30])}let e=document.getElementById("objSelect");for(let t in i)(h=document.createElement("option")).appendChild(document.createTextNode(t)),h.setAttribute("value",t),e.appendChild(h);e=document.getElementById("mtlSelect");for(let t in s.materialLib){var h;(h=document.createElement("option")).appendChild(document.createTextNode(t)),h.setAttribute("value",t),e.appendChild(h)}s.renderLoop((t=>{t.canvas.parentNode.querySelector(".fps").innerHTML=t.timer.FPS.toFixed(2);let s=i[document.getElementById("objSelect").value];Array.isArray(s)?(document.getElementById("mtlSelect").disabled=!0,s.forEach((([s,i,e,h])=>{s.transform=mat4().scale(2.3).rotate(t.timer.localTime*h,e).translate(i),s.draw()}))):(document.getElementById("mtlSelect").disabled=!1,s.setMtl(t.materialLib[document.getElementById("mtlSelect").value]),s.transform=mat4().rotate(90*t.timer.localTime,vec3(1,2,3)),s.draw())}))}()}))}();
